<div class="container mt-4">
    <h2 class="mb-3">Employee List</h2>
  
    <table class="table table-bordered table-striped">
      <thead class="table-dark text-center">
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Number</th>
          <th>Account No</th>
          <th>Role</th>
          <th>User Profile</th>
          <th>Current Address</th>
          <th>Permanent Address</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let emp of employeeList" [id]="'row-' + emp.id">
          <td>{{ emp.id }}</td>
          <td>{{ emp.name }}</td>
          <td>{{ emp.email }}</td>
          <td>{{ emp.number }}</td>
          <td>{{ emp.accountNo }}</td>
          <td class="fw-bold text-primary">{{ emp.role }}</td>
          <td>
            <img [src]="emp.image" width="60" height="60" class="rounded-circle">
          </td>
          <td>
            {{ emp.addresses[0]?.houseNo }}, {{ emp.addresses[0]?.street }},
            {{ emp.addresses[0]?.city }}, {{ emp.addresses[0]?.state }},
            {{ emp.addresses[0]?.pincode }}
          </td>
          <td>
            {{ emp.addresses[1]?.houseNo }}, {{ emp.addresses[1]?.street }},
            {{ emp.addresses[1]?.city }}, {{ emp.addresses[1]?.state }},
            {{ emp.addresses[1]?.pincode }}
          </td>
          <td>
            <button class="btn btn-primary btn-sm me-2" (click)="openEditForm(emp)">Update</button>
            <button class="btn btn-danger btn-sm" *ngIf="emp.id !== undefined" (click)="deleteEmployee(emp.id!)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  
    <!--  Update Form -->
    <div *ngIf="selectedEmployee" id="updateForm" class="accordion mt-4" id="updateAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingUpdate">
          <button
            class="accordion-button show"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseUpdate"
            aria-expanded="true"
            aria-controls="collapseUpdate"
          >
            Update Employee: {{ selectedEmployee.name }}
          </button>
        </h2>
        <div
          id="collapseUpdate"
          class="accordion-collapse collapse show"
          aria-labelledby="headingUpdate"
          data-bs-parent="#updateAccordion"
        >
          <div class="accordion-body">
            <form (ngSubmit)="updateEmployee(selectedEmployee.id!, selectedEmployee)">
              <!-- Basic Info -->
              <div class="row">
                <div class="col-md-6 mb-2">
                  <label>Name:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.name" name="name" />
                </div>
                <div class="col-md-6 mb-2">
                  <label>Email:</label>
                  <input type="email" class="form-control" [(ngModel)]="selectedEmployee.email" name="email" />
                </div>
              </div>
  
              <div class="row">
                <div class="col-md-6 mb-2">
                  <label>Number:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.number" name="number" />
                </div>
                <div class="col-md-6 mb-2">
                  <label>Account No:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.accountNo" name="accountNo" />
                </div>

                <div class="col-md-6">
                  <label class="form-label">User Profile</label>
                  <input
                    type="file"
                    class="form-control"
                    name="image"
                    (change)="onImageSelect($event)"
                  />
                </div>
                
              </div>
  
              <hr />
  
              <!-- Current Address -->
              <h5>Current Address</h5>
              <div class="row">
                <div class="col-md-4 mb-2">
                  <label>House No:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[0].houseNo" name="cHouseNo" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>Street:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[0].street" name="cStreet" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>City:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[0].city" name="cCity" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>State:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[0].state" name="cState" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>Pincode:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[0].pincode" name="cPincode" />
                </div>
              </div>
  
              <hr />
  
              <!-- Permanent Address -->
              <h5>Permanent Address</h5>
              <div class="row">
                <div class="col-md-4 mb-2">
                  <label>House No:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[1].houseNo" name="pHouseNo" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>Street:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[1].street" name="pStreet" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>City:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[1].city" name="pCity" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>State:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[1].state" name="pState" />
                </div>
                <div class="col-md-4 mb-2">
                  <label>Pincode:</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedEmployee.addresses[1].pincode" name="pPincode" />
                </div>
              </div>
  
              <button type="submit" class="btn btn-success mt-3">Update</button>
              <button type="button" class="btn btn-secondary mt-3 ms-2" (click)="cancelEdit()">Cancel</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  